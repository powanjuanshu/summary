<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>jms中topic和queue的区别_.Net编程 - 好工具站长分享平台</title><meta name="keywords" content="jms中topic和queue的区别" /><meta name="description" content="一：jboss的环境配置（略）二：开发环境jboss-4.2.2.ga+jdk1.6三：jms简单介绍1．当你发送一个消息，你不能直接发送到对此消息感兴趣的接受者。而是你发送到一个目的地。对此消息感兴趣的接" /><link rel="shortcut icon" type="image/x-icon" href="http://www.haogongju.net/favicon.ico" /><link rel="stylesheet" type="text/css" href="/skin/css/content.css" /><script type="text/javascript" src="http://cbjs.baidu.com/js/m.js"></script><script type="text/javascript">BAIDU_CLB_preloadSlots("600387", "600825", "600386", "595317", "595322", "595318", "600712");</script></head><body><div id="mainbox"><div id="header"><div class="logo"><a href="http://www.haogongju.net/" title="好工具-站长资讯、经验、工具分享平台">好工具-站长资讯、经验、工具分享平台</a><div class="ad_top_left"><script type="text/javascript">BAIDU_CLB_fillSlot("600825");</script></div></div><div class="nav"><ul><li><a href="http://www.haogongju.net/">首页</a></li><li><a href="http://www.haogongju.net/hulianwang">互联网</a></li><li><a href="http://www.haogongju.net/wangzhanyunying">网站运营</a></li><li><a href="http://www.haogongju.net/tool">站长工具</a></li><li><a href="http://www.haogongju.net/wangluobiancheng">网络编程</a></li></ul></div></div><div class="haogongju_index"><div class="left"><div class="guide">当前位置: <a href="http://www.haogongju.net/" target="_blak">好工具</a> &gt;&gt; <a href="http://www.haogongju.net/wangluobiancheng" target="_blank">网络编程</a> &gt;&gt; <a href="http://www.haogongju.net/net" target="_self">.Net编程</a></div><div class="guidead"><script type="text/javascript">BAIDU_CLB_fillSlot("600387");</script></div><div id="content"><h1>jms中topic和queue的区别</h1><div id="content_info"><span id="info"></span>2013/4/28 11:56:03</div><div id="content_art"><div class="ad_content_right"><script type="text/javascript">BAIDU_CLB_fillSlot("600386");</script></div><p>一：<span style="font-family: 'Times New Roman';">Jboss</span>的环境配置（略）</p>
<p>二：开发环境<span style="font-family: 'Times New Roman';">jboss-4.2.2.GA+JDK1.6</span></p>
<p>三：<span style="font-family: 'Times New Roman';">&nbsp;JMS&nbsp;</span>简单介绍</p>
<p><span>1．<span>&nbsp;</span></span><span>当你发送一个消息，你不能直接发送到对此消息感兴趣的接受者。而是你发送到一个目的地。对此消息感兴趣的接受者必须连接到目的地，得到此消息或在目的地设置订阅。</span></p>
<p><span><span style="font-family: 'Times New Roman';">2．<span>&nbsp;</span></span></span><span>在</span><span>JMS</span><span>中有两种域：</span><span>topics&nbsp;</span><span>和</span><span>queues&nbsp;</span><span>。</span></p>
<p><span>一个消息发送到一个</span><span>topics&nbsp;</span><span>，可以有多个<a href="http://www.haogongju.net/tag/%E5%AE%A2%E6%88%B7%E7%AB%AF" target="_blank" title="客户端">客户端</a>。用</span><span>topic</span><span>发布允许一对多，或多对多通讯通道。消息的产生者被叫做</span><span>publisher,</span><span>消息接受者叫做</span><span>subscriber</span><span>。</span></p>
<p><span>queue&nbsp;</span><span>是另外一种方式，仅仅允许一个消息传送给一个客户。一个发送者将消息放在消息队列中，接受者从队列中抽取并得到消息，消息就会在队列中消失。第一个接受者抽取并得到消息后，其他人就不能在得到它。</span></p>
<p><span>为了能发送和接收消息，必须得到一个</span><span>JMS</span><span>连接。该连接是使用</span><span>JMS Provider</span><span>得到连接的，在得到连接之后，建立一个会话</span><span>(Session)</span><span>。然后再建立</span><span>publisher/sender&nbsp;</span><span>来发送消息或</span><span>subscriber/receiver</span><span>来接收消息。</span><span>&nbsp;</span><span>运行时，如果使用</span><span>topic&nbsp;</span><span>那么</span><span>publisher</span><span>或</span><span>subscriber&nbsp;</span><span>通过一个</span><span>topic</span><span>来关联，如果使用</span><span>queue&nbsp;</span><span>，则</span><span>sender&nbsp;</span><span>或</span><span>receiver</span><span>通过</span><span>queue</span><span>来关联起来。</span></p>
<p><span>3．<span>&nbsp;</span></span><span>在</span><span>JMS</span><span>框架中运转的方法如下：</span></p>
<p><span>(1)&nbsp;</span><span>得到一个</span><span>JNDI</span><span>初始化上下文</span><span>(Context)</span><span>；</span></p>
<p><span>(2)&nbsp;</span><span>根据上下文来查找一个连接工厂</span><span>TopicConnectFactory/ QueueConnectionFactory (</span><span>有两种连接工厂，根据是</span><span>topic/queue</span><span>来使用相应的类型</span><span>)</span><span>；</span></p>
<p><span>(3)&nbsp;</span><span>从连接工厂得到一个连接</span><span>(Connect&nbsp;</span><span>有两种</span><span>[TopicConnection/ QueueConnection]);</span></p>
<p><span>(4)&nbsp;</span><span>通过连接来建立一个会话</span><span>(Session);</span></p>
<p><span>(5)&nbsp;</span><span>查找目的地</span><span>(Topic/ Queue);</span></p>
<p><span>(6)&nbsp;</span><span>根据会话以及目的地来建立消息制造者</span><span>(TopicPublisher/QueueSender)</span><span>和消费者</span><span>(TopicSubscriber/ QueueReceiver).</span></p>
<p>四：代码分析</p>
<p><span>1)&nbsp;</span><span>初始化上下文</span></p>
<p><span>配置</span><span>JNDI</span><span>的一个方法是通过属性文件</span><span>jndi.properties</span><span>。在这个文件中使用正确的值，并且把它所在的路径包含到</span><span>classpath</span><span>中，它比较容获得正确初始化上下文。</span><span>&nbsp;jndi.properties</span><span>文件的内容如下：</span></p>
<p><span>java.naming.factory.initial=org.jnp.interfaces.NamingContextFactory java.naming.provider.url=localhost:1099 java.naming.factory.url.pkgs=org.jboss.naming:org.jnp.interfaces</span></p>
<p><span>把该文件放置的路径成为你的</span><span>classpath</span><span>的一部分。</span></p>
<p><span>2)&nbsp;</span><span>查找连接工厂</span></p>
<p><span>查找连接工厂的代码如下：</span><span>&nbsp;</span><span>对于一个</span><span>topic</span><span>目的地</span></p>
<p><span>TopicConnectionFactory topicFactory = (TopicConnectionFactory) context.lookup (&ldquo;ConnectionFactory&rdquo;)</span></p>
<p><span>Queue&nbsp;</span><span>目的地：</span><span>&nbsp;QueueConnectionFactory queueFactory = (QueueConnectionFactory ) context.lookup (&ldquo;ConnectionFactory&rdquo;)</span></p>
<p><span>3)&nbsp;</span><span>建立连接和会话。</span></p>
<p><span>对于</span><span>topic</span><span>代码如下：</span><span>&nbsp;//</span><span>建立一个连接</span></p>
<p><span>topicConnection = topicFactory.createTopicConnection();</span></p>
<p><span>//</span><span>建立一个会话</span></p>
<p><span>topicSession = topicConnection.createTopicSession(false, //</span><span>不需要事务</span><span>&nbsp;Session.AUTO_ACKNO<a href="http://www.haogongju.net/tag/LED" target="_blank" title="LED">LED</a>GE //</span><span>自动接收消息的收条。</span><span>);</span></p>
<p><span>对于</span><span>queue</span><span>代码如下：</span><span>&nbsp;//</span><span>建立一个连接</span></p>
<p><span>queueConnection = queueFactory.createQueueConnection();</span></p>
<p><span>//</span><span>建立一个会话</span></p>
<p><span>queueSession = queueConnection .createQueueSession(false, //</span><span>不需要事务</span><span>&nbsp;Session.AUTO_ACKNOLEDGE //</span><span>自动接收消息的收条。</span><span>&nbsp;);</span></p>
<p><span>4)&nbsp;</span><span>查找目的地</span></p>
<p><span>对于</span><span>topic&nbsp;</span><span>查找一个</span><span>testTopic</span><span>目的地</span></p>
<p><span>Topic topic = (Topic) context.lookup(&ldquo;topic/testTopic&rdquo;);</span></p>
<p><span>对于</span><span>queue&nbsp;</span><span>查找一个</span><span>testQueue</span><span>目的地</span><span>&nbsp;Queue queue= (Queue) context.lookup(&ldquo;queue/testQueue&rdquo;);</span></p>
<p><span>（</span><span>5</span><span>）建立一个消息制造者</span><span>Message Producer (topic publisher/ queue sender)&nbsp;</span><span>消息制造者是一个由</span><span>session</span><span>创建的对象，主要工作是发送消息到目的地。</span></p>
<p><span>对于一个</span><span>topic</span><span>，需要通过</span><span>TopicSession</span><span>来创建一个</span><span>TopicPublisher</span><span>。代码如下：</span><span>&nbsp;TopicPublisher topicPublisher = TopicSession.createPublisher(topic);</span></p>
<p><span>对于一个</span><span>queue</span><span>，需要通过</span><span>QueueSession</span><span>来创建一个</span><span>QueueSender</span><span>。代码如下：</span><span>&nbsp;QueuePublisher queuePublisher = queueSession.createSender(queue);</span></p>
<p><span>6)&nbsp;</span><span>消息发送</span></p>
<p><span>建立一个</span><span>TestMessage</span><span>并且</span><span>publish&nbsp;</span><span>它，</span><span>&nbsp;</span><span>代码：</span></p>
<p><span>TextMessage message = topicSession.createTestMessage(); message.setText(msg); topicPublishe.publish(topic, message);</span></p>
<p><span>建立一个</span><span>TestMessage</span><span>并且</span><span>send</span><span>它，代码：</span></p>
<p><span>TextMessage message= queueSession.createTestMessage(); message.setText(msg); queueSender.send(queue, message);</span></p><br/></div><div class="ad_content_bottom"><script type="text/javascript">BAIDU_CLB_fillSlot("595318");</script></div><div class="share"><div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare"><span class="bds_more">分享到：</span> <a class="bds_qzone">QQ空间</a> <a class="bds_tsina">新浪微博</a> <a class="bds_tqq">腾讯微博</a> <a class="bds_renren">人人网</a> <a class="bds_hi">百度空间</a> <a class="bds_baidu">百度搜藏</a> <a class="bds_qq">QQ收藏</a> <a class="bds_tieba">百度贴吧</a></div></div><div class="clear"></div><div class="prevnextblock">上一篇： <a href="http://www.haogongju.net/art/1979380">maven加载oracle驱动</a></br>下一篇： <a href="http://www.haogongju.net/art/1979382">HandlerThread实现多线程操作_个人学习小结</a></br></div><script  type="text/javascript" charset="utf-8"  src="http://tui.cnzz.net/cs.php?id=1000016836"></script></div><div class="commentlist"><div class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = { short_name: "haogongju" };(function () {var ds = document.createElement('script');ds.type = 'text/javascript'; ds.async = true;ds.src = 'http://static.duoshuo.com/embed.js';ds.charset = 'UTF-8';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);})();</script></div></div><div class="right"><div class="ad_right_top"><script src="http://www.haogongju.net/ad/search.js" type="text/javascript"></script></div><div class="ad_right_center"><script type="text/javascript">BAIDU_CLB_fillSlot("600712");</script></div><div class="right_bolck"><h3>.Net编程 最新发布文章</h3><ul><li><a href="http://www.haogongju.net/art/1979382" title="HandlerThread实现多线程操作_个人学习小结" target="_blank">HandlerThread实现多线程操作_个人学习小结</a></li><li><a href="http://www.haogongju.net/art/1979383" title="jSWindow对象简介" target="_blank">jSWindow对象简介</a></li><li><a href="http://www.haogongju.net/art/1979384" title="ASP.NET很容易的图片裁剪功能" target="_blank">ASP.NET很容易的图片裁剪功能</a></li><li><a href="http://www.haogongju.net/art/1979386" title="delphi用IdTCPServer和IdTCPClient传输文件" target="_blank">delphi用IdTCPServer和IdTCPClient传输文件</a></li><li><a href="http://www.haogongju.net/art/1979389" title="DelphiXE2新增System.Zip单元,可用一句话压缩整个文件夹了" target="_blank">DelphiXE2新增System.Zip单元,可用一句</a></li><li><a href="http://www.haogongju.net/art/1979392" title="高手在民间：【当延长65岁退休——】" target="_blank">高手在民间：【当延长65岁退休——】</a></li><li><a href="http://www.haogongju.net/art/1979393" title="测试网站性能工具汇总" target="_blank">测试网站性能工具汇总</a></li><li><a href="http://www.haogongju.net/art/1979395" title="delphi创建webservice" target="_blank">delphi创建webservice</a></li><li><a href="http://www.haogongju.net/art/1979397" title="Mongodb学习笔记5：索引" target="_blank">Mongodb学习笔记5：索引</a></li></ul></div><div class="ad_right_center"><script type="text/javascript">BAIDU_CLB_fillSlot("595317");</script></div><div class="right_bolck"><h3>.Net编程 一周点击文章</h3><ul><li><a href="http://www.haogongju.net/art/1978493" title="监控MSSQL数据库的DDL操作&laquo;&raquo;" target="_blank">监控MSSQL数据库的DDL操作&laquo;&raquo;</a></li><li><a href="http://www.haogongju.net/art/1979123" title="Spring简单持久层ORM实现之dbutils" target="_blank">Spring简单持久层ORM实现之dbutils</a></li><li><a href="http://www.haogongju.net/art/1978880" title="园子-[闪存]chrome插件&laquo;" target="_blank">园子-[闪存]chrome插件&laquo;</a></li><li><a href="http://www.haogongju.net/art/1978868" title="如何解决Office2010安装报错1907，没有足够权限注册字体？" target="_blank">如何解决Office2010安装报错1907，没有</a></li><li><a href="http://www.haogongju.net/art/1979161" title="PowerDesigner使用教程——概念数据模型" target="_blank">PowerDesigner使用教程——概念数据模型</a></li><li><a href="http://www.haogongju.net/art/1979151" title="基本操作代码" target="_blank">基本操作代码</a></li><li><a href="http://www.haogongju.net/art/1978489" title="ExtJs十一(ExtJsMvc图片管理之一)" target="_blank">ExtJs十一(ExtJsMvc图片管理之一)</a></li><li><a href="http://www.haogongju.net/art/1979314" title="关于在winform下调用cmd" target="_blank">关于在winform下调用cmd</a></li><li><a href="http://www.haogongju.net/art/1979124" title="(API)32位程序读取64位注册表" target="_blank">(API)32位程序读取64位注册表</a></li><li><a href="http://www.haogongju.net/art/1978579" title="WebView控件中的onConsoleMessage方法不被调用" target="_blank">WebView控件中的onConsoleMessage方法不</a></li></ul></div><div class="right_bolck"><h3>.Net编程 一月点击文章</h3><ul><li><a href="http://www.haogongju.net/art/1979268" title="VS2010\VS2012打不开VS2008开发项目" target="_blank">VS2010\VS2012打不开VS2008开发项目</a></li><li><a href="http://www.haogongju.net/art/1978787" title="Heritrix3.1.0源码解析（二十四）" target="_blank">Heritrix3.1.0源码解析（二十四）</a></li><li><a href="http://www.haogongju.net/art/1979102" title="Hibernate配置" target="_blank">Hibernate配置</a></li><li><a href="http://www.haogongju.net/art/1979094" title="项目中遇到的一些问题的总结的解决办法" target="_blank">项目中遇到的一些问题的总结的解决办法</a></li><li><a href="http://www.haogongju.net/art/1979373" title="[AX]AX2012商业智能分析" target="_blank">[AX]AX2012商业智能分析</a></li><li><a href="http://www.haogongju.net/art/1979070" title="25个开始学习HTMLE5的最好的资源" target="_blank">25个开始学习HTMLE5的最好的资源</a></li><li><a href="http://www.haogongju.net/art/1979059" title="Clientunabletoestablishaconnection" target="_blank">Clientunabletoestablishaconnection</a></li><li><a href="http://www.haogongju.net/art/1979253" title="C#后台调用跨域MVC服务，带Cookie验证&laquo;" target="_blank">C#后台调用跨域MVC服务，带Cookie验证&la</a></li><li><a href="http://www.haogongju.net/art/1979294" title="c#里BindingFlags筛选标志" target="_blank">c#里BindingFlags筛选标志</a></li><li><a href="http://www.haogongju.net/art/1978866" title="[转]用Vim编写汇编程序设置" target="_blank">[转]用Vim编写汇编程序设置</a></li></ul></div><div class="ad_right_bottom"><script type="text/javascript">BAIDU_CLB_fillSlot("595322");</script></div></div></div><div id="bottom"><div class="bottom_images"></div><p class="link"><a href="http://kuaidi.henyuanma.com/" title="快递查询">快递查询</a><a href="http://tianqi.henyuanma.com/beijing" title="北京天气">北京天气</a><a href="http://tianqi.henyuanma.com/shanghai" title="上海天气">上海天气</a><a href="http://tianqi.henyuanma.com/shenzhen" title="深圳天气">深圳天气</a><a href="http://tianqi.henyuanma.com/guangzhou" title="广州天气">广州天气</a><a href="http://tianqi.henyuanma.com/tianjin" title="天津天气">天津天气</a><a href="http://tianqi.henyuanma.com/jinan" title="济南天气">济南天气</a><a href="http://tianqi.henyuanma.com/suzhou" title="苏州天气">苏州天气</a><a href="http://tianqi.henyuanma.com/hangzhou" title="杭州天气">杭州天气</a><a href="http://tianqi.henyuanma.com/nanjing" title="南京天气">南京天气</a><a href="http://tianqi.henyuanma.com/wuhan" title="武汉天气">武汉天气</a><a href="http://tianqi.henyuanma.com/changsha" title="长沙天气">长沙天气</a><a href="http://tianqi.henyuanma.com/xian" title="西安天气">西安天气</a><a href="http://tianqi.henyuanma.com/chongqing" title="重庆天气">重庆天气</a><a href="http://tianqi.henyuanma.com/chengdu" title="成都天气">成都天气</a><a href="http://tianqi.henyuanma.com/nanchang" title="南昌天气">南昌天气</a><a href="http://tianqi.henyuanma.com/xiamen" title="厦门天气">厦门天气</a><a href="http://tianqi.henyuanma.com/shenyang" title="沈阳天气">沈阳天气</a><a href="http://tianqi.henyuanma.com/zhuhai" title="珠海天气">珠海天气</a></p><p><a href="http://www.haogongju.net/abouthaogongju" target="_blank">关于好工具</a> <a href="http://www.haogongju.net/hulianwang" target="_blank">互联网资讯</a> <a href="http://www.haogongju.net/seo" target="_blank">Seo</a> <a href="http://www.haogongju.net/net" target="_blank">.Net编程</a> <a href="http://www.haogongju.net/sitemap" target="_blank"  class="bottomli">网站地图</a></p><p class="bottomli">Copyright 2011-2013 HaoGongJu.Net ( 好工具 ) All Rights Reserved<script src="http://s20.cnzz.com/stat.php?id=3021203&web_id=3021203" language="JavaScript"></script><script type="text/javascript"> var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F0be38d6025dddffb63569ca8991215d4' type='text/javascript'%3E%3C/script%3E"));</script></p></div></div><script type="text/javascript" src="/skin/js/common.js"></script><a href="javascript:void(0);" class="gotop_btn" id="goTopButton" style="display: none;">&nbsp;</a><script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=61841"></script><script type="text/javascript" id="bdshell_js"></script><script type="text/javascript">var bds_config = { 'bdText': 'jms中topic和queue的区别-好工具站长分享平台 一：jboss的环境配置（略）二：开发环境jboss-4.2.2.ga+jdk1.6三：jms简单介绍1．当你发送一个消息，你不能直接发送到对此消息感兴趣的接受者。而是你发送到一个目的地。对此消息感兴趣的接' };document.getElementById("bdshell_js").src = "http://share.baidu.com/static/js/shell_v2.js?t=" + new Date().getHours();a(1979381);</script><script type="text/javascript">/*120*270，创建于2012-1-10 主站*/var cpro_id = 'u738901';</script><script src="http://cpro.baidu.com/cpro/ui/f.js" type="text/javascript"></script></body></html>